# BTC价格预测系统使用指南

本系统使用微调后的Kronos模型进行BTC价格预测，提供了三种不同的预测脚本：

## 脚本说明

### 1. `btc_prediction.py` - 基础预测脚本
- **功能**: 基本的BTC价格预测
- **输出**: 简单的价格和成交量预测图表
- **特点**: 快速、简单，适合快速查看预测结果

### 2. `btc_prediction_with_uncertainty.py` - 带不确定性分析的预测脚本
- **功能**: 预测BTC价格并计算不确定性度量
- **输出**: 包含置信区间、标准差等统计信息的图表
- **特点**: 提供预测的可靠性评估，适合需要了解预测精度的情况

### 3. `btc_prediction_kline.py` - K线图预测脚本
- **功能**: 使用K线图形式展示预测结果，包含概率信息
- **输出**: 专业的K线图，显示预测趋势和不确定性
- **特点**: 最直观的可视化方式，适合专业分析

## 使用方法

### 环境要求
确保已安装以下依赖：
```bash
pip install torch pandas numpy matplotlib requests
```

### 运行脚本

#### 方法1: 基础预测
```bash
python btc_prediction.py
```

#### 方法2: 带不确定性分析的预测
```bash
python btc_prediction_with_uncertainty.py
```

#### 方法3: K线图预测（推荐）
```bash
python btc_prediction_kline.py
```

## 输出文件说明

运行脚本后，会生成以下文件：

1. **预测结果文件** (CSV格式):
   - `btc_prediction_YYYYMMDD_HHMMSS.csv` - 基础预测结果
   - `btc_prediction_uncertainty_YYYYMMDD_HHMMSS.csv` - 带不确定性的预测结果
   - `btc_prediction_kline_YYYYMMDD_HHMMSS.csv` - K线图预测结果

2. **可视化图表** (PNG格式):
   - `btc_prediction_YYYYMMDD_HHMMSS.png` - 基础预测图表
   - `btc_prediction_uncertainty_YYYYMMDD_HHMMSS.png` - 带不确定性的图表
   - `btc_prediction_kline_YYYYMMDD_HHMMSS.png` - K线图

3. **详细采样数据** (仅限不确定性分析):
   - `btc_all_samples_YYYYMMDD_HHMMSS.csv` - 所有采样结果

## 预测参数说明

### 主要参数
- **lookback_window**: 512 (使用过去512小时的数据作为输入)
- **pred_len**: 48 (预测未来48小时)
- **sample_count**: 20 (用于计算不确定性的采样次数)

### 模型参数
- **T**: 1.0 (温度参数，控制预测的随机性)
- **top_p**: 0.9 (核采样参数)
- **clip**: 5.0 (数据裁剪范围)

## 预测结果解读

### 基础预测
- 直接显示预测的价格和成交量数值
- 适合快速了解未来趋势

### 不确定性分析
- **均值**: 预测的中心值
- **标准差**: 预测的波动程度
- **5th/95th分位数**: 95%置信区间
- **最小值/最大值**: 预测的可能范围

### K线图分析
- **绿色K线**: 预测上涨（收盘价 >= 开盘价）
- **红色K线**: 预测下跌（收盘价 < 开盘价）
- **透明度**: 表示预测的确定性（越不透明越确定）
- **灰色背景**: 不确定性范围
- **橙色条**: 预测不确定性程度

## 概率信息说明

K线图版本提供了以下概率信息：

1. **趋势概率**: 通过K线颜色和透明度显示
2. **不确定性度量**: 底部的橙色条形图
3. **价格范围**: 灰色背景显示95%置信区间
4. **上涨概率**: 在预测摘要中显示整体上涨概率

## 注意事项

1. **数据获取**: 脚本会自动从币安API获取最新的BTC数据
2. **模型路径**: 确保微调后的模型文件存在于指定路径
3. **计算资源**: 预测需要一定的计算时间，建议使用GPU加速
4. **预测限制**: 预测结果仅供参考，不构成投资建议

## 自定义配置

如需修改预测参数，可以编辑脚本中的以下变量：

```python
# 修改预测时长
pred_len = 72  # 预测72小时

# 修改采样次数
sample_count = 30  # 增加采样次数以提高精度

# 修改历史数据天数
days = 60  # 使用60天的历史数据
```

## 故障排除

### 常见问题

1. **导入错误**: 确保Kronos模块路径正确
2. **数据获取失败**: 检查网络连接和API限制
3. **内存不足**: 减少采样次数或预测长度
4. **模型加载失败**: 检查模型文件路径和完整性

### 联系支持

如遇到问题，请检查：
1. Python环境和依赖包版本
2. 模型文件是否完整
3. 网络连接状态
4. 系统资源使用情况